<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Friends Trip Picker ‚Äî Offbeat India (Dec‚ÄìJan)</title>
<meta name="description" content="Vote on unique, hidden-trip ideas across India. Hampi, Meghalaya, Vattakanal, Koyna‚ÄìVasota, Tipeshwar, and more. Live leaderboard, filters, Google links, sharable votes." />
<style>
  :root{
    --bg0:#070b17; --bg1:#0c1227; --bg2:#0b1633;
    --fg:#e9f0ff; --muted:#a7b3d0; --line:#1e2a55;
    --chip:#141e3d; --chipOn:#1f2b55; --accent:#86ffd1; --accent2:#ffd166;
    --card:#0f1733; --card2:#0b1226; --glow:#86ffd144;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--fg); font-family: ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial;
    background:
      radial-gradient(1200px 600px at 10% -10%, #243b55 0%, transparent 60%),
      radial-gradient(900px 600px at 120% 10%, #141e30 0%, transparent 60%),
      linear-gradient(160deg, var(--bg1), var(--bg2) 70%);
    min-height:100%;
  }

  header, .footbar {
    position: sticky; inset-inline: 0;
    backdrop-filter: saturate(130%) blur(8px);
    background: #0b1120cc; z-index: 40; border-block: 1px solid var(--line);
  }
  header{ top:0 }
  .footbar{ bottom:0 }

  .wrap{max-width:1200px; margin:0 auto; padding:14px 16px}
  h1{margin:0 0 6px; font-weight:800; letter-spacing:.2px}
  .sub{margin:0 0 10px; color:var(--muted)}

  .toolbar{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
  .chip{
    padding:8px 12px; border-radius:999px; background:var(--chip); color:#cfe0ff;
    border:1px solid var(--line); cursor:pointer; user-select:none; transition:.15s;
    font-size:14px
  }
  .chip.on{background:var(--chipOn); border-color:#34437a}
  .chip:hover{transform:translateY(-1px); box-shadow:0 6px 16px -8px #000}

  .searchbar{display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin-top:10px}
  input[type="search"]{
    background:#0b1226; color:var(--fg); border:1px solid var(--line);
    padding:8px 12px; border-radius:10px; min-width:230px; flex:1
  }
  .btn{
    background:#0e1633; color:#dff7ff; border:1px solid #263469; padding:8px 12px;
    border-radius:10px; cursor:pointer; transition:.15s; font-weight:700
  }
  .btn:hover{transform:translateY(-1px); box-shadow:0 8px 18px -10px #000}
  .btn.hot{background:linear-gradient(90deg,#19d1a3,#8ff); color:#041519; border-color:#52e7d2}
  .btn.ghost{background:transparent}

  .layout{display:grid; grid-template-columns:1fr 320px; gap:16px}
  @media (max-width: 1024px){ .layout{grid-template-columns:1fr} }

  .grid{display:grid; gap:14px; grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); padding:16px 0 120px}
  .card{
    background:linear-gradient(180deg,var(--card),var(--card2));
    border:1px solid var(--line); border-radius:16px; padding:14px; position:relative;
    box-shadow:0 10px 30px -20px #000, 0 0 0 1px #0a132b inset; overflow:hidden
  }
  .title{font-weight:800; font-size:18px; margin:2px 32px 6px 0}
  .badge{position:absolute; top:10px; right:10px; font-size:12px; padding:4px 8px; border-radius:999px;
         border:1px solid #2a376a; background:#0d1633; color:#b8c7ff}
  .why{color:#d9e6ff; font-size:14px; margin:6px 0 10px}
  .meta{color:var(--muted); font-size:12px; display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px}
  .tag{font-size:12px; padding:2px 8px; border-radius:999px; border:1px solid #2b3767; color:#b8c7ff; background:#0e1633}
  .actions{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
  .vote{display:inline-flex; align-items:center; gap:6px}
  .count{font-weight:800; color:var(--accent)}

  aside .panel{
    background:linear-gradient(180deg,var(--card),var(--card2));
    border:1px solid var(--line); border-radius:14px; padding:12px; margin:8px 0
  }
  .lead{display:flex; flex-direction:column; gap:10px}
  .lead .row{display:flex; justify-content:space-between; align-items:center; gap:8px}
  .lead .name{font-weight:700}
  .lead .score{font-weight:800; color:var(--accent2)}
  .crown{filter: drop-shadow(0 0 6px #ffd16666)}
  .hint{color:#9fb2e8; font-size:12px}

  .footbar .wrap{display:flex; justify-content:space-between; gap:10px; align-items:center; flex-wrap:wrap}
  .selected{display:flex; flex-wrap:wrap; gap:6px}
  .pill{display:inline-flex; align-items:center; gap:6px; background:#0e1734; border:1px solid #263469; padding:6px 10px; border-radius:999px; font-size:13px}

  .spark{position:fixed; inset:0; pointer-events:none; z-index:100}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>üåø Friends Trip Picker ‚Äî Offbeat India (Dec‚ÄìJan)</h1>
    <p class="sub">Vote your favourites. Filter, search, and share. Each card links to a Google search.</p>

    <div class="toolbar" id="filters">
      <div class="chip on" data-tag="mountains">Mountains</div>
      <div class="chip on" data-tag="beach">Beaches</div>
      <div class="chip on" data-tag="forest">Forests</div>
      <div class="chip on" data-tag="rivers">Rivers</div>
      <div class="chip on" data-tag="desert">Desert</div>
      <div class="chip on" data-tag="culture">Culture</div>
      <div class="chip on" data-tag="psy">Trippy</div>
      <div class="chip on" data-tag="zero-crowd">Hidden</div>
    </div>

    <div class="searchbar">
      <input id="q" type="search" placeholder="Search destinations, states, vibes‚Ä¶" />
      <button class="btn" id="clear">Clear</button>
      <button class="btn ghost" id="randomize">üé≤ Randomize</button>
      <button class="btn hot" id="share">üîó Share Votes</button>
      <span class="hint">Tip: your votes auto-save on this browser.</span>
    </div>
  </div>
</header>

<div class="wrap layout">
  <main>
    <div class="grid" id="grid"></div>
  </main>

  <aside>
    <div class="panel">
      <h3 style="margin:6px 0 4px">üèÜ Leaderboard</h3>
      <div id="leaderboard" class="lead"></div>
    </div>
    <div class="panel">
      <h3 style="margin:6px 0 4px">üîé Quick Google</h3>
      <p class="hint">Open a destination‚Äôs Google search from any card, or <a id="pageSearch" class="inline" href="#" target="_blank" rel="noopener">search this page title on Google</a>.</p>
    </div>
    <div class="panel">
      <h3 style="margin:6px 0 4px">‚ÑπÔ∏è About</h3>
      <p class="hint">These are hand-picked, offbeat-leaning options ideal for Dec‚ÄìJan. Use filters to narrow by vibe; hit ‚ÄúShare Votes‚Äù to copy a link that encodes your current scores.</p>
    </div>
  </aside>
</div>

<div class="footbar">
  <div class="wrap">
    <div id="selected" class="selected"></div>
    <div class="row">
      <button class="btn" id="resetVotes">üóëÔ∏è Reset Votes</button>
      <button class="btn" id="sortVotes">Sort by Votes</button>
    </div>
  </div>
</div>

<canvas class="spark" id="spark"></canvas>

<script>
/* -------------------- DATA -------------------- */
/* From all our chats: core offbeat set + Maharashtra forests */
const DESTS = [
  // Core ‚Äúliked Hampi + offbeat‚Äù group
  {id:'hampi-deep', name:'Hampi + Anegundi/Sanapur + Sandur', state:'Karnataka',
    why:'Boulder valleys, ruins, river-island hush; red-ore canyon drives.',
    tags:['psy','culture','mountains','rivers','zero-crowd']},
  {id:'gokarna-arc', name:'Gokarna Quiet Arc + Kumta‚ÄìHonnavar Coves', state:'Karnataka Coast',
    why:'Cliff trails to pocket beaches, bioluminescence nights (if lucky).',
    tags:['beach','psy','zero-crowd']},
  {id:'vattakanal', name:'Vattakanal + Poombarai', state:'Tamil Nadu',
    why:'Cloud forests, boho caf√©s, acoustic jams; Kodai without crowds.',
    tags:['mountains','forest','psy','zero-crowd']},
  {id:'sainj', name:'Sainj Valley (GHNP back-valley)', state:'Himachal',
    why:'Cedar woods, stone hamlets, massive starfields.',
    tags:['mountains','forest','zero-crowd']},
  {id:'kasar-binsar', name:'Kasar Devi Ridge + Binsar', state:'Uttarakhand',
    why:'Old hippie-trail energy; Himalayan sunsets from pine ridges.',
    tags:['mountains','psy','forest','zero-crowd']},
  {id:'meghalaya', name:'Meghalaya: Shnongpdeng ‚Üí Dawki ‚Üí Nongriat', state:'Meghalaya',
    why:'Living root bridges, glass-clear rivers, easy caves.',
    tags:['rivers','forest','psy','zero-crowd']},
  {id:'andaman-slow', name:'Andamans: Neil (Shaheed) + Long Island', state:'Andaman & Nicobar',
    why:'Forest-to-beach hikes, reef flats, plankton nights.',
    tags:['beach','forest','zero-crowd']},
  {id:'valparai', name:'Valparai + Sholayar', state:'TN/Kerala Border',
    why:'Tea highlands, rainforest gullies, lion-tailed macaques.',
    tags:['forest','mountains','zero-crowd']},
  {id:'dhanushkodi', name:'Dhanushkodi + Gulf of Mannar', state:'Tamil Nadu',
    why:'End-of-the-land sandspit, glassy lagoons, wind & kites.',
    tags:['beach','psy','zero-crowd']},
  {id:'chettinad', name:'Chettinad Mansions (Karaikudi Belt)', state:'Tamil Nadu',
    why:'Palatial homes, Athangudi tiles, cycle past craft clusters.',
    tags:['culture','zero-crowd']},
  {id:'valiyaparamba', name:'Valiyaparamba + Kavvayi Backwaters', state:'North Kerala',
    why:'Backwaters without Alleppey crowds; islands & sandbars.',
    tags:['rivers','beach','zero-crowd']},
  {id:'bhogwe', name:'Bhogwe‚ÄìNivati‚ÄìVengurla Arc', state:'South Maharashtra',
    why:'Empty coves, laterite cliffs, teal water; pre-2005 Goa vibe.',
    tags:['beach','zero-crowd']},
  {id:'kutch', name:'Kutch Crafts + White Rann', state:'Gujarat',
    why:'Salt-desert moonscapes with living craft villages.',
    tags:['desert','culture','zero-crowd']},
  {id:'dzongu', name:'Dzongu (Lepcha Reserve)', state:'North Sikkim',
    why:'Sacred groves, hot springs, rivers; Lepcha culture.',
    tags:['mountains','forest','zero-crowd']},

  // Maharashtra forests (new ask)
  {id:'koyna', name:'Koyna‚ÄìVasota', state:'Maharashtra',
    why:'Boat across Koyna backwaters + jungle trek to cliff-top fort.',
    tags:['forest','rivers','zero-crowd']},
  {id:'chandoli', name:'Chandoli National Park', state:'Maharashtra',
    why:'Maratha forts swallowed by forest; gaur & civet nights.',
    tags:['forest','zero-crowd']},
  {id:'radhanagari', name:'Radhanagari Bison Sanctuary', state:'Maharashtra',
    why:'Foggy grasslands, gaur herds, blue-hour plateaus.',
    tags:['forest','zero-crowd']},
  {id:'amboli', name:'Amboli Ghats', state:'Maharashtra',
    why:'Western Ghats shola cloud-forest, moody winter hikes.',
    tags:['forest','mountains','zero-crowd']},
  {id:'phansad', name:'Phansad Wildlife Sanctuary', state:'Maharashtra',
    why:'Coastal forest + watchtowers; sea-breeze mornings.',
    tags:['forest','rivers','zero-crowd']},
  {id:'bhimashankar', name:'Bhimashankar WLS', state:'Maharashtra',
    why:'Sacred groves, giant Malabar squirrels, mossy stone trails.',
    tags:['forest','mountains','zero-crowd']},
  {id:'tamhini', name:'Tamhini‚ÄìMulshi Belt', state:'Maharashtra',
    why:'Fern gullies, mirror lakes, blue-hour photography.',
    tags:['forest','rivers','zero-crowd']},
  {id:'nagzira', name:'Navegaon‚ÄìNagzira TR', state:'Maharashtra',
    why:'Twin lakes, bamboo‚Äìsal mosaics, superb birding.',
    tags:['forest','rivers','zero-crowd']},
  {id:'tipeshwar', name:'Tipeshwar WLS', state:'Maharashtra',
    why:'Compact teak forest with frequent big-cat sightings.',
    tags:['forest','psy']},
  {id:'umred', name:'Umred‚ÄìKarhandla', state:'Maharashtra',
    why:'Raw teak corridors; old-school forest energy.',
    tags:['forest','zero-crowd']},
  {id:'melghat', name:'Melghat TR (Satpura)', state:'Maharashtra',
    why:'Deep valleys, sparkling night skies, tribal hamlets.',
    tags:['forest','mountains','zero-crowd']},
  {id:'pench-mh', name:'Pench (Sillari, MH side)', state:'Maharashtra',
    why:'Kipling woods; calmer gates than MP side.',
    tags:['forest','rivers']}
];

/* -------------------- STATE -------------------- */
const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));

const votesKey = 'tripVotes_v1';
const picksKey = 'tripPicks_v1';

let votes = loadVotes();
let activeTags = new Set(['mountains','beach','forest','rivers','desert','culture','psy','zero-crowd']);
let searchQ = '';

/* -------------------- RENDER -------------------- */
function render(){
  const grid = $('#grid');
  grid.innerHTML = '';

  const filtered = DESTS.filter(d => {
    const tagsOk = [...activeTags].length
      ? d.tags.some(t => activeTags.has(t))
      : true;
    const q = searchQ.trim().toLowerCase();
    const qOk = !q || (d.name.toLowerCase().includes(q) || d.state.toLowerCase().includes(q) || d.tags.join(' ').includes(q));
    return tagsOk && qOk;
  });

  // sort if "Sort by Votes" toggled
  if($('#sortVotes').dataset.sorted === 'true'){
    filtered.sort((a,b)=> (votes[b.id]||0) - (votes[a.id]||0));
  }

  filtered.forEach(d => {
    const v = votes[d.id] || 0;
    const card = document.createElement('div');
    card.className = 'card';
    const isTop = isTopDestination(d.id);
    card.innerHTML = `
      <div class="badge">${d.state}${isTop ? ' ¬∑ <span class="crown">üëë Top</span>' : ''}</div>
      <div class="title">${d.name}</div>
      <div class="meta">${d.tags.map(t=>`<span class="tag">#${t}</span>`).join(' ')}</div>
      <p class="why">${d.why}</p>
      <div class="actions">
        <div class="vote">
          <button class="btn" aria-label="Vote ${d.name}" data-vote="${d.id}">üëç Vote</button>
          <span class="count" id="c_${d.id}">${v}</span>
        </div>
        <a class="btn ghost" target="_blank" rel="noopener"
           href="${googleLink(d.name)}">üîé Google it</a>
        <button class="btn ghost" data-pick="${d.id}">‚≠ê Pin</button>
      </div>
    `;
    grid.appendChild(card);
  });

  updateLeaderboard();
  renderPinned();
}

function renderPinned(){
  const sel = $('#selected');
  const pinned = loadPicks();
  sel.innerHTML = '';
  if(!pinned.length){ sel.innerHTML = '<span class="hint">Pin favourites to see them here.</span>'; return; }
  pinned.forEach(id=>{
    const d = DESTS.find(x=>x.id===id);
    if(!d) return;
    const pill = document.createElement('div');
    pill.className = 'pill';
    pill.innerHTML = `‚≠ê ${d.name} <button class="btn ghost" data-unpin="${id}">‚úï</button>`;
    sel.appendChild(pill);
  });
}

/* -------------------- HELPERS -------------------- */
function googleLink(name){
  const q = encodeURIComponent(`${name} India`);
  return `https://www.google.com/search?q=${q}`;
}
function loadVotes(){
  try{
    const qs = new URLSearchParams(location.search);
    if(qs.get('votes')){
      const imported = JSON.parse(decodeURIComponent(qs.get('votes')));
      localStorage.setItem(votesKey, JSON.stringify(imported));
      history.replaceState({}, '', location.pathname); // clean URL
      return imported;
    }
    return JSON.parse(localStorage.getItem(votesKey) || '{}');
  }catch(e){ return {} }
}
function saveVotes(){ localStorage.setItem(votesKey, JSON.stringify(votes)); }
function topScore(){
  const arr = DESTS.map(d=>votes[d.id]||0);
  return arr.length ? Math.max(...arr) : 0;
}
function isTopDestination(id){ return (votes[id]||0) === topScore() && topScore() > 0; }

function updateLeaderboard(){
  const board = $('#leaderboard');
  const sorted = [...DESTS].sort((a,b)=> (votes[b.id]||0) - (votes[a.id]||0)).slice(0,8);
  board.innerHTML = '';
  sorted.forEach((d,i)=>{
    const row = document.createElement('div');
    row.className = 'row';
    const crown = isTopDestination(d.id) ? ' üëë' : '';
    row.innerHTML = `<span class="name">${i+1}. ${d.name}${crown}</span>
                     <span class="score">${votes[d.id]||0}</span>`;
    board.appendChild(row);
  });
  if(!sorted.length){
    board.innerHTML = '<span class="hint">No votes yet. Click üëç on a card.</span>';
  }
}

/* -------------------- EVENTS -------------------- */
document.addEventListener('click', (e)=>{
  const vId = e.target?.dataset?.vote;
  if(vId){
    votes[vId] = (votes[vId]||0) + 1;
    saveVotes();
    const el = document.getElementById('c_'+vId);
    if(el) el.textContent = votes[vId];
    confetti();
    updateLeaderboard();
    // refresh crowns
    render();
    return;
  }
  const pId = e.target?.dataset?.pick;
  if(pId){
    const arr = loadPicks();
    if(!arr.includes(pId)){ arr.push(pId); }
    localStorage.setItem(picksKey, JSON.stringify(arr));
    renderPinned();
    return;
  }
  const un = e.target?.dataset?.unpin;
  if(un){
    const arr = loadPicks().filter(x=>x!==un);
    localStorage.setItem(picksKey, JSON.stringify(arr));
    renderPinned();
    return;
  }
});

$('#q').addEventListener('input', e=>{ searchQ = e.target.value; render(); });
$('#clear').addEventListener('click', ()=>{ $('#q').value=''; searchQ=''; render(); });

$('#randomize').addEventListener('click', ()=>{
  // temporarily shuffle rendering order (not votes)
  $('#sortVotes').dataset.sorted = 'false';
  DESTS.sort(()=> Math.random()-.5);
  render();
});

$('#sortVotes').addEventListener('click', (e)=>{
  const on = e.target.dataset.sorted === 'true';
  e.target.dataset.sorted = on ? 'false' : 'true';
  e.target.textContent = on ? 'Sort by Votes' : 'Sorted ‚úì';
  render();
});

$('#resetVotes').addEventListener('click', ()=>{
  if(confirm('Reset all votes on this browser?')){ votes={}; saveVotes(); render(); }
});

$('#share').addEventListener('click', ()=>{
  const votesStr = encodeURIComponent(JSON.stringify(votes));
  const url = `${location.origin}${location.pathname}?votes=${votesStr}`;
  navigator.clipboard.writeText(url).then(()=>{
    alert('Shareable link copied! It includes your current votes.');
  });
});

$('#pageSearch').setAttribute('href',
  'https://www.google.com/search?q='+encodeURIComponent(document.title+' site:'));

/* Filters */
$$('.chip').forEach(ch=>{
  ch.addEventListener('click', ()=>{
    const tag = ch.dataset.tag;
    if(ch.classList.contains('on')){ ch.classList.remove('on'); activeTags.delete(tag); }
    else { ch.classList.add('on'); activeTags.add(tag); }
    render();
  });
});

/* Pinned helpers */
function loadPicks(){ try{ return JSON.parse(localStorage.getItem(picksKey) || '[]'); }catch(e){ return [] } }

/* -------------------- CONFETTI (tiny) -------------------- */
const spark = document.getElementById('spark');
const ctx = spark.getContext('2d');
let parts = [];
function resize(){ spark.width = innerWidth; spark.height = innerHeight; }
addEventListener('resize', resize); resize();

function confetti(){
  for(let i=0;i<40;i++){
    parts.push({
      x: innerWidth/2, y: innerHeight-80, vx:(Math.random()-0.5)*6, vy:-Math.random()*6-4,
      r: Math.random()*3+2, a: 1, c: `hsl(${Math.random()*60+150} 90% 60%)`
    });
  }
  if(!anim) animate();
}
let anim=null;
function animate(){
  if(anim) cancelAnimationFrame(anim);
  ctx.clearRect(0,0,spark.width,spark.height);
  parts.forEach(p=>{
    p.vy += 0.12; p.x += p.vx; p.y += p.vy; p.a *= 0.985;
    ctx.globalAlpha = p.a; ctx.fillStyle = p.c;
    ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill();
  });
  parts = parts.filter(p=>p.a>0.02 && p.y < innerHeight+20);
  if(parts.length){ anim = requestAnimationFrame(animate); } else { anim=null; }
}

/* -------------------- INIT -------------------- */
render();
</script>
</body>
</html>
